# [7] ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ - ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…

### í•™ìŠµ ëª©í‘œ

1. ë‹¤ì–‘í•œ ì˜ì¡´ ê´€ê³„ ì£¼ì… ë°©ë²•ì„ ì•ˆë‹¤.
2. ì˜µì…˜ ì²˜ë¦¬ì— ëŒ€í•´ ì•ˆë‹¤.
3. ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…ì˜ ìµœì‹  íŠ¸ë Œë“œì— ëŒ€í•´ ì•ˆë‹¤.

## 1. ë‹¤ì–‘í•œ ì˜ì¡´ ê´€ê³„ ì£¼ì… ë°©ë²•
ì˜ì¡´ ê´€ê³„ ì£¼ì…ì€ í¬ê²Œ 4ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.
1. ìƒì„±ì ì£¼ì…
2. ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)
3. í•„ë“œ ì£¼ì…
4. ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…


### 1. ìƒì„±ì ì£¼ì…
- ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²•
- íŠ¹ì§•
  - ìƒì„±ì í˜¸ì¶œ ì‹œì ì— ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ë³´ì¥í•œë‹¤
  - **ë¶ˆë³€, í•„ìˆ˜ ì˜ì¡´ ê´€ê³„** ì—ì„œ ì‚¬ìš©í•¨
```java
@Component
public class OrderServiceImpl implements OrderService {

  private final MemberRepository memberRepository;
  private final DiscountPolicy discountPolicy;

  @Autowired
  public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
  }
}
```
- â­ï¸ ìƒì„±ìê°€ ë”± 1ê°œë§Œ ìˆë‹¤ë©´, `@Autowired` ë¥¼ ìƒëµí•´ë„ ëœë‹¤!


### 2. ìˆ˜ì •ì ì£¼ì… (setter ì£¼ì…)
- **setter**ë¼ ë¶ˆë¦¬ëŠ” í•„ë“œì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œë¥¼ í†µí•´ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•
- íŠ¹ì§•
  - **ì„ íƒì ì¸, ë³€ê²½ ê°€ëŠ¥ì„±** ì´ ìˆëŠ” ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©
  - ìë°” ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ì˜ ìˆ˜ì •ì ë©”ì„œë“œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
```java
@Component
public class OrderServiceImpl implements OrderService {
  private MemberRepository memberRepository;
  private DiscountPolicy discountPolicy;

  @Autowired
  public void setMemberRepository(MemberRepository memberRepository) {
    this.memberRepository = memberRepository;
  }

  @Autowired
  public void setDiscountPolicy(DiscountPolicy discountPolicy) {
    this.discountPolicy = discountPolicy;
  }
  ...
}
```
- ğŸ“Œ ì°¸ê³ 
  - `@Autowired` ì˜ ê¸°ë³¸ ë™ì‘ì€ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤
  - ì£¼ì…í•  ëŒ€ìƒì´ ì—†ì–´ë„ ë™ì‘í•˜ê²Œ í•˜ë ¤ë©´ `@Autowired(required = false)` ë¡œ ì§€ì •í•˜ë©´ ëœë‹¤

- ğŸ“Œ ìë°” ë¹ˆ í”„ë¡œí¼í‹° ê·œì•½ ì˜ˆì‹œ
```java
class Data {
  private int age;
  public void setAge(int age) {
    this.age = age;
  }

  public int getAge() {
    return age;
  }
}
```

### 3. í•„ë“œ ì£¼ì…
- í•„ë“œì— ë°”ë¡œ ì£¼ì…í•˜ëŠ” ë°©ë²•
- íŠ¹ì§•
  - ì½”ë“œê°€ ê°„ê²°í•˜ë‹¤, ê·¸ëŸ¬ë‚˜ ì™¸ë¶€ì—ì„œ ë³€ê²½ í•˜ê¸° í˜ë“¤ì–´ì„œ í…ŒìŠ¤íŠ¸ê°€ í˜ë“¤ë‹¤
  - DI í”„ë ˆì„ì›Œí¬ê°€ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ë‹¤
  - ì‚¬ìš© í•˜ì§€ ë§ ê²ƒ
```java
@Component
public class OrderServiceImpl implements OrderService {

  @Autowired
  private MemberRepository memberRepository;

  @Autowired
  private DiscountPolicy discountPolicy;
}
```

### 4. ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…
- ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ ì£¼ì… ë°›ëŠ” ë°©ë²•
- íŠ¹ì§•
  - í•œ ë²ˆì— ì—¬ëŸ¬ í•„ë“œë¥¼ ì£¼ì… ë°›ì„ ìˆ˜ ìˆìŒ
  - ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ (ìƒì„±ì ì£¼ì…ê³¼ ìˆ˜ì •ì ì£¼ì…ì—ì„œ ë‹¤ í•´ê²°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—)
```java
@Component
public class OrderServiceImpl implements OrderService {
  private MemberRepository memberRepository;
  private DiscountPolicy discountPolicy;

  @Autowired
  public void init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
  }
}
```
â­ï¸ ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì…ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ì–´ì•¼ ë™ì‘í•œë‹¤. ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹Œ ë‹¤ë¥¸ í´ë˜ìŠ¤ì—ì„œ `@Autowired` ì½”ë“œë¥¼ ì ìš©í•´ë„ ì•„ë¬´ ê¸°ëŠ¥ë„ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤ â­ï¸

## 2. ì˜µì…˜ ì²˜ë¦¬
- ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼ ë  ë•Œê°€ ìˆëŠ”ë°, `@Autowired` ë§Œ ì‚¬ìš©í•˜ë©´ `required` ì˜µì…˜ì˜ default ê°’ì´ `true` ì—¬ì„œ ìë™ ì£¼ì… ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤

### ìë™ ì£¼ì… ëŒ€ìƒì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•
1. `@Autowired(required = false)`
   - ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ ìì²´ê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤
2. `org.springframework.lang.@Nullable`
   - ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ nullì´ ì…ë ¥ëœë‹¤
3. `Optional<>`
   - ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ `Optional.empty` ê°€ ì…ë ¥ëœë‹¤

```java
// í˜¸ì¶œ ì•ˆë¨
@Autowired(required = false)
public void setNoBean1(Member noBean1) {
    System.out.println("noBean1 = " + noBean1);
}

// null í˜¸ì¶œ
@Autowired
public void setNoBean2(@Nullable Member noBean2) {
    System.out.println("noBean2 = " + noBean2);
}

// Optional.empty í˜¸ì¶œ
@Autowired
public void setNoBean3(Optional<Member> noBean3) {
    System.out.println("noBean3 = " + noBean3);
}
```
![autowired_test](images/2022/11/autowired-test.png)

- `Member` ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹ˆë‹¤
  - ê·¸ë˜ì„œ `setNoBean1()` ì€ `@Autowired(required = false)` ì´ë¯€ë¡œ í˜¸ì¶œ ìì²´ê°€ ì•ˆëœë‹¤

## 3. ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•´ë¼!
  ê³¼ê±°ì—ëŠ” ìˆ˜ì •ì ì£¼ì…ê³¼ í•„ë“œ ì£¼ì…ì„ ë§ì´ ì‚¬ìš©í–ˆì§€ë§Œ, ìµœê·¼ì—ëŠ” ìŠ¤í”„ë§ì„ í¬í•¨í•œ DI í”„ë ˆì„ì›Œí¬ ëŒ€ë¶€ë¶„ì´ ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥í•œë‹¤.

- 1. **ë¶ˆë³€**
   - ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ ì£¼ì…ì€ í•œ ë²ˆ ì¼ì–´ë‚˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì‹œì ê¹Œì§€ ì˜ì¡´ ê´€ê³„ë¥¼ ë³€ê²½í•  ì¼ì´ ì—†ë‹¤. ì˜¤íˆë ¤ ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì „ê¹Œì§€ ë³€í•˜ë©´ ì•ˆëœë‹¤. (ë¶ˆë³€í•´ì•¼ í•œë‹¤)
   - ìˆ˜ì •ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´, setXXX ë©”ì„œë“œë¥¼ publicìœ¼ë¡œ ì—´ì–´ë‘ì–´ì•¼ í•œë‹¤.
     - ëˆ„êµ°ê°€ ì‹¤ìˆ˜ë¡œ ë³€ê²½í•  ìˆ˜ë„ ìˆê³ , ë³€ê²½í•˜ë©´ ì•ˆë˜ëŠ” ë©”ì„œë“œë¥¼ ì—´ì–´ë‘ëŠ” ê²ƒì€ ì¢‹ì€ ì„¤ê³„ ë°©ë²•ì´ ì•„ë‹ˆë‹¤.
     - ìƒì„±ì ì£¼ì…ì€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ë¯€ë¡œ ì´í›„ì— í˜¸ì¶œë˜ëŠ” ì¼ì´ ì—†ë‹¤. ë”°ë¼ì„œ ë¶ˆë³€í•˜ë„ë¡ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤
- 2. **ëˆ„ë½**
   - í”„ë ˆì„ì›Œí¬ ì—†ì´ ìˆœìˆ˜í•œ ìë°” ì½”ë“œë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²½ìš° ëˆ„ë½ëœ ì‚¬í•­ì„ ì¸ì§€í•  ìˆ˜ ìˆë‹¤.
- 3. **final í‚¤ì›Œë“œ**
   - ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í•„ë“œì— `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì„œ ìƒì„±ìì—ì„œ í˜¹ì‹œë¼ë„ ê°’ì´ ì„¤ì •ë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ì‹œì ì— ë§‰ì•„ì¤€ë‹¤.
   - ğŸ“Œ ì°¸ê³ 
     - ìˆ˜ì •ì ì£¼ì…ì„ í¬í•¨í•œ ë‚˜ë¨¸ì§€ ì£¼ì… ë°©ì‹ì€ ëª¨ë‘ ìƒì„±ì ì´í›„ì— í˜¸ì¶œë˜ë¯€ë¡œ, í•„ë“œì— `final` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤

## 4. ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ë Œë“œ
- ë§‰ìƒ ê°œë°œì„ í•´ë³´ë©´, ëŒ€ë¶€ë¶„ì´ ë‹¤ ë¶ˆë³€ì´ê³ , ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±ìì— final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤...
- ê·¸ëŸ°ë°, ìƒì„±ìë„ ë§Œë“¤ì–´ì•¼ í•˜ê³ , ì£¼ì… ë°›ì€ ê°’ì„ ëŒ€ì…í•˜ëŠ” ì½”ë“œë„ ë§Œë“¤ì–´ì•¼ í•˜ê³  => ê·€ì°®ë‹¤!!!
- ë¡¬ë³µì—ì„œ ì œê³µí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´ë³´ì

#### ê¸°ë³¸ ì½”ë“œ
```java
@Component
public class OrderServiceImpl implements OrderService {

  private final MemberRepository memberRepository;
  private final DiscountPolicy discountPolicy;

  @Autowired
  public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
  }
}
```

#### ë¡¬ë³µì´ ì œê³µí•˜ëŠ” `@RequiredArgsConstructor` ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ finalì´ ë¶™ì€ í•„ë“œë¥¼ ëª¨ì•„ì„œ ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤
```java
@Component
@RequiredArgsConstructor
public class OrderServiceImpl implements OrderService {

  private final MemberRepository memberRepository;
  private final DiscountPolicy discountPolicy;
}
```
- `@RequiredArgsConstructor` ì„ ì‚¬ìš©í•˜ë©´ ë¡¬ë³µì´ ìë°”ì˜ ì• ë…¸í…Œì´ì…˜ í”„ë¡œì„¸ì„œë¼ëŠ” ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ ì»´íŒŒì¼ ì‹œì ì— ìƒì„±ì ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì¤€ë‹¤
<br>
- ìµœê·¼ì—ëŠ” ìƒì„±ìë¥¼ ë”± 1ê°œ ë‘ê³ , `@Autowired`ë¥¼ ìƒëµí•˜ëŠ” ë°©ë²•ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤

## 5. ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ - ë¬¸ì œ
- `@Autowired` ëŠ” íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œë‹¤
- ì„ íƒëœ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ë•Œ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ”ë°, ì´ëŸ´ ë•ŒëŠ” ì–´ë–»ê²Œ í•´ê²°í•´ì•¼ í• ê¹Œ??

## 6. @Autowired í•„ë“œëª…, @Qualifier, @Primary
- ì¡°íšŒ ëŒ€ìƒ ë¹ˆì´ 2ê°œ ì´ìƒì¼ ë•Œ í•´ê²° ë°©ë²•
  1. `@Autowired` í•„ë“œ ëª… ë§¤ì¹­
  2. `@Qualifier` -> `@Qualifier` ë¼ë¦¬ ë§¤ì¹­ -> ë¹ˆ ì´ë¦„ ë§¤ì¹­
  3. `@Primary` ì‚¬ìš©

### 1. `@Autowired` í•„ë“œëª… ë§¤ì¹­
- `@Autowired` ëŠ” íƒ€ì… ë§¤ì¹­ì„ ì‹œë„í•˜ê³ , ì´ ë•Œ ì—¬ëŸ¬ ë¹ˆì´ ìˆìœ¼ë©´, í•„ë“œ ì´ë¦„(íŒŒë¼ë¯¸í„° ì´ë¦„)ìœ¼ë¡œ ë¹ˆ ì´ë¦„ì„ ì¶”ê°€ ë§¤ì¹­í•œë‹¤
#### ê¸°ì¡´ ì½”ë“œ
```java
@Autowired
private DiscountPolicy discountPolicy;
```

#### í•„ë“œëª…ì„ ë¹ˆ ì´ë¦„ìœ¼ë¡œ ë³€ê²½
```java
@Autowired
private DiscountPolicy rateDiscountPolicy;
```

#### `@Autowired` ë§¤ì¹­ ì •ë¦¬
1. íƒ€ì… ë§¤ì¹­
2. íƒ€ì… ë§¤ì¹­ì˜ ê²°ê³¼ê°€ 2ê°œ ì´ìƒì¼ ë•Œ í•„ë“œëª…, íŒŒë¼ë¯¸í„° ëª…ìœ¼ë¡œ ë¹ˆ ì´ë¦„ ë§¤ì¹­

### 2. @Qualifier ì‚¬ìš©
`@Qualifier` ëŠ” ì¶”ê°€ êµ¬ë¶„ìë¥¼ ë¶™ì—¬ì£¼ëŠ” ë°©ë²•ìœ¼ë¡œ, ì£¼ì… ì‹œ ì¶”ê°€ì ì¸ ë°©ë²•ì„ ì œê³µí•˜ëŠ” ê²ƒì´ì§€ ë¹ˆ ì´ë¦„ì„ ë³€ê²½í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤
#### ë¹ˆ ë“±ë¡ ì‹œ `@Qualifier` ë¥¼ ë¶™ì—¬ì¤€ë‹¤
```java
@Component
@Qualifier("mainDiscountPolicy")
public class RateDiscountPolicy implements DiscountPolicy { ... }
```

#### ìƒì„±ì ìë™ ì£¼ì… ì˜ˆì‹œ
```java
public OrderServiceImpl(MemberRepository memberRepository,@Qualifier("mainDiscountPolicy") DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
}
```

- `@Qualifier` ë¡œ ì£¼ì…í•  ë•Œ, `@Qualifier("mainDiscountPolicy")` ë¥¼ ëª»ì°¾ìœ¼ë©´ ì–´ë–»ê²Œ ë ê¹Œ?
  - mainDiscountPolicy ë¼ëŠ” ì´ë¦„ì˜ ìŠ¤í”„ë§ ë¹ˆì„ ì¶”ê°€ë¡œ ì°¾ëŠ”ë‹¤

#### `@Qualifier` ì •ë¦¬
1. `@Qualifier` ë¼ë¦¬ ë§¤ì¹­
2. ë¹ˆ ì´ë¦„ ë§¤ì¹­
3. `NoSuchBeanDefinition` ì˜ˆì™¸ ë°œìƒ

### 3. @Primary ì‚¬ìš©
- ìš°ì„ ìˆœìœ„ë¥¼ ì§€ì •í•˜ëŠ” ë°©ë²•
```java
@Component
@Primary
public class RateDiscountPolicy implements DiscountPolicy {}
```

#### @Primary, @Qualifierì˜ ìš°ì„ ìˆœìœ„
- `@Qualifier` ê°€ ìš°ì„ ìˆœìœ„ê°€ ë” ë†’ë‹¤

## 7. ì• ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°
```java
@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER, ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Inherited
@Documented
@Qualifier("mainDiscountPolicy")
public @interface MainDiscountPolicy {}
```

```java
@Component
@MainDiscountPolicy
public class RateDiscountPolicy implements DiscountPolicy {}
```

```java
public OrderServiceImpl(MemberRepository memberRepository, @MainDiscountPolicy DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
}
```
- ì• ë…¸í…Œì´ì…˜ì—ëŠ” ìƒì†ì´ë¼ëŠ” ê°œë…ì´ ì—†ë‹¤.

## 8. ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ, List, Map
- ì˜ë„ì ìœ¼ë¡œ ì •ë§ í•´ë‹¹ íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ë‹¤ í•„ìš”í•œ ê²½ìš°ë„ ìˆë‹¤
```java
public class AllBeanTest {
    @Test
    void findAllBean() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policies;

        @Autowired
        public DiscountService(Map<String, DiscountPolicy> policyMap, List<DiscountPolicy> policies) {
            this.policyMap = policyMap;
            this.policies = policies;
            System.out.println("policyMap = " + policyMap);
            System.out.println("policies = " + policies);
        }
    }
}
```
![policyMap_policies](images/2022/11/policymap-policies.png)
- `DiscountService` ëŠ” Mapìœ¼ë¡œ ëª¨ë“  `DiscountPolicy`ë¥¼ ì£¼ì…ë°›ëŠ”ë‹¤. ì´ ë•Œ, `fixDiscountPolicy`ì™€ `rateDiscountPolicy` ê°€ ì£¼ì…ëœë‹¤

```java
public class AllBeanTest {
    @Test
    void findAllBean() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);

        DiscountService discountService = ac.getBean(DiscountService.class);
        Member member = new Member(1L, "user!", Grade.VIP);
        int discountPrice = discountService.discount(member, 10000, "fixDiscountPolicy");

        assertThat(discountService).isInstanceOf(DiscountService.class);
        assertThat(discountPrice).isEqualTo(1000);

        int rateDiscountPrice = discountService.discount(member, 20000, "rateDiscountPolicy");
        assertThat(rateDiscountPrice).isEqualTo(2000);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policies;

        @Autowired
        public DiscountService(Map<String, DiscountPolicy> policyMap, List<DiscountPolicy> policies) {
            this.policyMap = policyMap;
            this.policies = policies;
            System.out.println("policyMap = " + policyMap);
            System.out.println("policies = " + policies);
        }

        public int discount(Member member, int price, String discountCode) {
            DiscountPolicy discountPolicy = policyMap.get(discountCode);
            return discountPolicy.discount(member, price);
        }
    }
}
```
- `Map<String, DiscountPolicy>` : mapì˜ í‚¤ì— ìŠ¤í”„ë§ ë¹ˆì˜ ì´ë¦„ì„ ë„£ì–´ì£¼ê³ , ê·¸ ê°’ìœ¼ë¡œ `DiscountPolicy` íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆì„ ë‹´ì•„ì¤€ë‹¤
- `List<DiscountPolicy>` : `DiscountPolicy` íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆì„ ë‹´ì•„ì¤€ë‹¤
- ë§Œì•½, í•´ë‹¹í•˜ëŠ” íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìœ¼ë©´, ë¹ˆ ì»¬ë ‰ì…˜ì´ë‚˜ Mapì„ ì£¼ì…í•œë‹¤
