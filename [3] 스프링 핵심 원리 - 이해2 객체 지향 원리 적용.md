# [3] μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ - μ΄ν•΄2 κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

### ν•™μµ λ©ν‘

1. μƒλ΅μ΄ μ”κµ¬μ‚¬ν•­μ— λ€ν•΄ κ°λ°ν•κ³  μ΄λ¥Ό κ°λ°ν•λ” λ°μ— μμ–΄μ„ λ°μƒν•λ” λ¬Έμ μ μ„ μ• μ μλ‹¤.
2. κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•΄λ³Ό μ μλ‹¤.



μ΄μ „μ— κ°λ°ν–λ μ½”λ“κ°€ μ •λ§ κ°μ²΄ μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ μ¤€μν–λ”μ§€ ν™•μΈν•΄λ³΄μ. μ΄λ²μ—λ” μ£Όλ¬Έν• κΈμ•΅μ %λ¥Ό ν• μΈν•΄μ£Όλ” μƒλ΅μ΄ μ •λ¥  ν• μΈ μ •μ±…μ„ μ¶”κ°€ν•λ‹¤.

## 1. ν• μΈ μ •μ±…μ„ μ• ν”λ¦¬μΌ€μ΄μ…μ— μ μ©ν•κΈ°

<img src="image/discount-policy.png" alt="image-20211122215506108" style="zoom:33%;" />

- **ν• μΈ μ •μ±…μ„ μ‹¤μ μ μΌλ΅ μ μ©ν•λ ¤λ©΄, ν΄λΌμ΄μ–ΈνΈμΈ `OrderServiceImpl` μ„ κ³ μ³μ•Ό ν•λ‹¤**

```java
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository = new MemoryMemberRepository();
//    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```



## 2. λ¬Έμ μ  λ°κ²¬

- μ—­ν• κ³Ό κµ¬ν„μ„ μ¶©μ‹¤ν•κ² λ¶„λ¦¬ν–λ”κ°€? -> O
- λ‹¤ν•μ„±λ„ ν™μ©ν•κ³ , μΈν„°νμ΄μ¤μ™€ κµ¬ν„ κ°μ²΄λ¥Ό λ¶„λ¦¬ν–λ”κ°€? -> O
- OCP, DIP μ™€ κ°™μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ¶©μ‹¤ν μ¤€μν–λ”κ°€?
  - κ·Έλ ‡κ² λ³΄μ΄μ§€λ§ μ‚¬μ‹¤μ€ μ•„λ‹λ‹¤

> 1. OCP (Open / Closed Principle) : κ°λ°© - νμ‡„ μ›μΉ™
>
> - μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤
>
> 2. DIP (Dependeny Inversion Principle) : μμ΅΄ κ΄€κ³„ μ—­μ „ μ›μΉ™
>
> - "μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤."
> - ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ **κµ¬ν„ ν΄λμ¤μ— μμ΅΄ν•μ§€ λ§κ³ , μΈν„°νμ΄μ¤μ— μμ΅΄ν•λΌ**

- DIP : μ£Όλ¬Έ μ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈ (`OrderServiceImpl`) μ€ `DiscountPolicy` μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ©΄μ„ DIPλ¥Ό μ§€ν‚¨ κ²ƒ κ°™μ€λ°??
  - μ¶”μƒν™”(μΈν„°νμ΄μ¤) λΏλ§ μ•„λ‹λΌ κµ¬μ²΄ν™”(κµ¬ν„) ν΄λμ¤μ—λ„ μμ΅΄ν•κ³  μλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤
    - μ¶”μƒν™” μμ΅΄ (μΈν„°νμ΄μ¤ μμ΅΄) : `DiscountPolicy`
    - κµ¬μ²΄ν™” μμ΅΄ (κµ¬ν„ ν΄λμ¤ μμ΅΄) : `FixDiscountPolicy` , `RateDiscountPolicy`
  - DIPλ¥Ό μ„λ°ν•κ³  μλ‹¤



#### κΈ°λ€ν–λ μμ΅΄ κ΄€κ³„

<img src="image/expected_dependency.png" alt="image-20211122221443649" style="zoom:33%;" />

- `DiscountPolicy` μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ‹¤κ³  μƒκ°ν–μ§€λ§, μ‚¬μ‹¤μ€

#### μ‹¤μ  μμ΅΄ κ΄€κ³„

<img src="image/real_dependency.png" alt="image-20211122221647326" style="zoom:33%;" />

- `FixDiscountPolicy` μΈ κµ¬μ²΄ ν΄λμ¤λ„ ν•¨κ» μμ΅΄ν•κ³  μλ‹¤. => π“ **DIPλ¥Ό μ„λ°!!**



#### λ§μ•½, μ •μ±…μ„ λ³€κ²½ν•λ©΄

<img src="image/change_discount_policy.png" alt="image-20211122221909374" style="zoom:33%;" />

- μ •μ±…μ„ `RateDiscountPolicy`λ΅ λ³€κ²½ν•λ” μκ°„ `OrderServiceImpl` μ μ½”λ“λ¥Ό ν•¨κ» λ³€κ²½ν•΄μ•Ό ν•λ‹¤ => π“ **OCPλ¥Ό μ„λ°**


- OCP : λ³€κ²½ν•μ§€ μ•κ³  ν™•μ¥ν•  μ μλ‹¤κ³  ν–λ”λ°???
  - `OrderServiceImpl` μ€ κΈ°λ¥μ„ ν™•μ¥ν•΄μ„ λ³€κ²½ν•λ©΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μν–¥μ„ μ¤€λ‹¤
  - λ”°λΌμ„ κΈ°λ¥μ„ ν™•μ¥ν•μ—¬ λ³€κ²½ν•λ” μκ°„ OCPλ¥Ό μ„λ°ν•λ‹¤κ³  ν•  μ μλ‹¤



#### κ²°λ΅ 

- ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈ `OrderServiceImpl` μ€ `DiscountPolicy` μ μΈν„°νμ΄μ¤ λΏλ§ μ•„λ‹λΌ κµ¬μ²΄ ν΄λμ¤λ„ ν•¨κ» μμ΅΄ν•λ‹¤ --> **DIP μ„λ°**
- **κµ¬μ²΄ ν΄λμ¤λ¥Ό λ³€κ²½ν•  λ•, ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν•λ‹¤**


###  κ·Έλ¬λ©΄ μ–΄λ–»κ² ν•΄κ²°ν•΄μ•Ό ν•λ”κ°€?

- DIP μ„λ°ν•λ‹κΉ
  - **μ¶”μƒμ—λ§ μμ΅΄ν•λ„λ΅ (μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅)** λ³€κ²½ν•΄μ•Ό ν•λ‹¤

#### μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„λ¥Ό λ³€κ²½ν•μ

<img src="image/expected_dependency.png" alt="image-20211122221443649" style="zoom: 25%;" />

```java
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository = new MemoryMemberRepository();

    private DiscountPolicy discountPolicy; // μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“λ¥Ό λ³€κ²½ν•λ‹¤

}
```

π¤” κµ¬ν„μ²΄κ°€ μ—†λ”λ° μ–΄λ–»κ² μ½”λ“λ¥Ό μ‹¤ν–‰ν•  μ μμ„κΉ??

- μ‹¤μ  μ‹¤ν–‰μ„ ν•΄λ³΄λ©΄ `NullPointerException` μ΄ λ°μƒν•λ‹¤

### π§ ν•΄κ²°λ°©μ•
- κ²°κµ­ **λ„κµ°κ°€**κ°€ ν΄λΌμ΄μ–ΈνΈμΈ `OrderServiceImpl` μ— `DiscountPolicy` μ **κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤**



## 3. κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬
- μ΄μ „κΉμ§€λ” κµ¬ν„μ²΄λ¥Ό μƒμ„±ν•κ³  μ„ νƒν•λ” λ“± λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μμ—λ‹¤.
- κ³µμ—° κΈ°νμλ¥Ό λ§λ“¤κ³ , λ°°μ°μ™€ κ³µμ—° κΈ°νμμ μ±…μ„μ„ ν™•μ‹¤ν λ¶„λ¦¬ν•μ
- **κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ**


### AppConfigμ λ“±μ¥
- μ• ν”λ¦¬μΌ€μ΄μ…μ μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±(config)ν•κΈ°  μ„ν•΄, **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•κ³ , μ—°κ²°ν•λ” **μ±…μ„**μ„ κ°€μ§€λ” λ³„λ„μ μ„¤μ • ν΄λμ¤λ¥Ό λ§λ“¤μ

- `AppConfig.java`

  ```java
  public class AppConfig {
  		public MemberService memberService() {
  				return new MemberServiceImpl(new MemoryMemberRepository());
  		}
  }
  ```

- `MemberServiceImpl`

  ```java
  public class MemberServiceImpl implements MemberService {

      private final MemberRepository memberRepository;

      // μƒμ„±μλ¥Ό ν†µν•΄ memberRepositoryμ κµ¬ν„μ²΄λ¥Ό μ§€μ •ν•λ‹¤
      public MemberServiceImpl(MemberRepository memberRepository) {
          this.memberRepository = memberRepository;
      }
  }
  ```

  - μ΄μ  μƒμ„±μλ¥Ό ν†µν•΄ `memberRepository` μ κµ¬ν„μ²΄λ¥Ό μ§€μ •ν•λ―€λ΅, `MemberServiceImpl` μ€ κµ¬μ²΄ν™”λ¥Ό μ „ν€ λ¨λ¥Έλ‹¤
    - μƒμ„±μλ¥Ό ν†µν•΄ κ°μ²΄κ°€ λ“¤μ–΄κ°„λ‹¤ => μƒμ„±μ μ£Όμ…

- λ™μΌν•κ² `OrderServiceImpl` λ„ λ°”κΎΈλ©΄,

- `AppConfig.java`

  ```java
  public class AppConfig {
      public MemberService memberService() {
          return new MemberServiceImpl(new MemoryMemberRepository());
      }

      public OrderService orderService() {
          return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
      }
  }
  ```

- `OrderServiceImpl`

  ```java
  public class OrderServiceImpl implements OrderService {

      private final MemberRepository memberRepository;
      private final DiscountPolicy discountPolicy;

      public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
          this.memberRepository = memberRepository;
          this.discountPolicy = discountPolicy;
      }
  }

  ```

##### μ² μ €ν•κ² DIPκ°€ μ§€μΌμ§€κ³  μλ‹¤

<img src="image/class_diagram.png" alt="image-20211122224047959" style="zoom:33%;" />



- `AppConfig` λ” μ• ν”λ¦¬μΌ€μ΄μ…μ μ‹¤μ  λ™μ‘μ— ν•„μ”ν• **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•λ‹¤
  1. `MemberServiceImpl`
  2. `MemoryMemberRepository`
  3. `OrderServiceImpl`
  4. `FixDiscountPolicy`
- `AppConfig` λ” μƒμ„±ν• κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°(λ νΌλ°μ¤)λ¥Ό **μƒμ„±μλ¥Ό ν†µν•΄μ„ μ£Όμ…(μ—°κ²°)** ν•΄μ¤€λ‹¤
  - `MemberServiceImpl` -> `MemoryMemberRepository`
  - `OrderServiceImpl` -> `MemoryMemberRepository`, `FixDiscountPolicy`

β­οΈ μ΄μ  μ„¤κ³„ λ³€κ²½μΌλ΅ `MemberServiceImpl` μ€ `MemoryMemberRepository` λ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤

- λ‹¨μ§€ `MemberRepository` λΌλ” μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ‹¤
- `MemberServiceImpl` μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€ (μ£Όμ…λ μ§€)λ” μ• μ μ—†λ‹¤
- `MemberServiceImpl` μ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ¥Ό μ£Όμ…ν• μ§€λ” μ¤μ§ μ™Έλ¶€ `AppConfig` μ—μ„ κ²°μ •λλ‹¤
- `MemberServiceImpl` μ€ μ΄μ λ¶€ν„° **μμ΅΄ κ΄€κ³„μ— λ€ν• κ³ λ―Όμ€ μ™Έλ¶€**μ— λ§΅κΈ°κ³  μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•λ©΄ λλ‹¤

<br/>
#### κ°μ²΄ μΈμ¤ν„΄μ¤ λ‹¤μ΄μ–΄κ·Έλ¨
<img src="image/dependency_injection.png" alt="image-20211122224205487" style="zoom:33%;" />

β­οΈ κ°μ²΄μ μƒμ„±κ³Ό μ—°κ²°μ€ `AppConfig`κ°€ λ‹΄λ‹Ήν•λ‹¤

- DIP μ™„μ„± : `MemberServiceImpl` μ€ `MemberRepository` μΈ μ¶”μƒμ—λ§ μμ΅΄ν•λ©΄ λλ‹¤. μ΄μ  λ”μ΄μƒ κµ¬μ²΄ ν΄λμ¤λ¥Ό λ°λΌλ„ λλ‹¤
- **κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬** : κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν• κ³Ό μ‹¤ν–‰ν•λ” μ—­ν• μ΄ λ…ν™•ν λ¶„λ¦¬λμ—λ‹¤
- `appConfig` κ°μ²΄λ” `memoryMemberRepository` κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ·Έ μ°Έμ΅°κ°’μ„ `memberServiceImpl` μ„ μƒμ„±ν•λ©΄μ„ μƒμ„±μλ΅ μ „λ‹¬ν•λ‹¤

β­οΈ ν΄λΌμ΄μ–ΈνΈμΈ `memberServiceImpl` μ…μ¥μ—μ„ λ³΄λ©΄ μμ΅΄κ΄€κ³„λ¥Ό λ§μΉ μ™Έλ¶€μ—μ„ μ£Όμ…ν•΄μ£Όλ” κ²ƒ κ°™λ‹¤κ³  ν•΄μ„ **DI (Dependency Injection)** λλ” μμ΅΄ κ΄€κ³„ μ£Όμ…(μμ΅΄μ„± μ£Όμ…)μ΄λΌκ³  ν•λ‹¤.

#### OrderServiceImpl
```java
public class OrderServiceImpl implements OrderService {

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discount = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discount);
    }
}
```
- μ„¤κ³„ λ³€κ²½μΌλ΅ μ΄μ  `OrderServiceImpl`μ€ `FixDiscountPolicy`λ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤!!
- λ‹¨μ§€ `DiscountPolicy` μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ‹¤
- `OrderServiceImpl` μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€λ” μ• μ μ—†λ‹¤
- `OrderServiceImpl` μ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ¥Ό μ£Όμ…ν• μ§€ κ²°μ ν•λ” κ²ƒμ€ μ™Έλ¶€μΈ `AppConfig` μ—μ„ κ²°μ •ν•λ‹¤
- `OrderServiceImpl`μ€ μ΄μ λ¶€ν„° μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•λ©΄ λλ‹¤
- `OrderServiceImpl` μ—λ” `MemoryMemberRepository, FixDiscountPolicy` κ°μ²΄μ μμ΅΄κ΄€κ³„κ°€ μ£Όμ…λλ‹¤


### μ •λ¦¬

- `AppConfig` λ¥Ό ν†µν•΄μ„ κ΄€μ‹¬μ‚¬λ¥Ό ν™•μ‹¤ν•κ² **λ¶„λ¦¬**ν–λ‹¤
- λ°°μ—­, λ°°μ°λ¥Ό μƒκ°ν•΄λ³΄μ
- `AppConfig` λ” κ³µμ—° κΈ°νμμ΄λ‹¤
- `AppConfig` λ” κµ¬μ²΄ ν΄λμ¤λ¥Ό μ„ νƒν•λ‹¤. λ°°μ—­μ— λ§λ” λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„ νƒν•λ‹¤. μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ–΄λ–»κ² λ™μ‘ν•΄μ•Ό ν• μ§€ μ „μ²΄ κµ¬μ„±μ„ μ±…μ„μ§„λ‹¤
- μ΄μ  κ° λ°°μ°λ“¤μ€ λ‹΄λ‹Ή κΈ°λ¥μ„ μ‹¤ν–‰ν•λ” μ±…μ„λ§ μ§€λ©΄ λλ‹¤
- `OrderServiceImpl` μ€ κΈ°λ¥μ„ μ‹¤ν–‰ν•λ” μ±…μ„λ§ μ§€λ©΄ λλ‹¤



## 4. AppConfig λ¦¬ν©ν„°λ§

- μ§€κΈμ `AppConfig` λ” μ¤‘λ³µμ΄ μκ³ , μ—­ν• μ— λ”°λ¥Έ κµ¬ν„μ΄ μ μ•λ³΄μΈλ‹¤

<img src="image/AppConfig.png" alt="image-20211122225004833" style="zoom: 50%;" />



### μ¤‘λ³µμ„ μ κ±°ν•κ³ , μ—­ν• μ— λ”°λ¥Έ κµ¬ν„μ΄ λ³΄μ΄λ„λ΅ λ¦¬ν©ν„°λ§ ν•μ

```java
public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    private MemoryMemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

#### μ¥μ 

- λ©”μ†λ“λ…λ§ λ³΄λ” μκ°„ μ—­ν• μ΄ μ λ“λ¬λ‚λ‹¤ (`AppConfig` λ¥Ό λ³΄λ©΄ μ—­ν• κ³Ό κµ¬ν„ ν΄λμ¤κ°€ ν• λμ— λ“¤μ–΄μ™€μ„ μ „μ²΄ μ• ν”λ¦¬μΌ€μ΄μ… κµ¬μ„±μ„ **ν• λμ— νμ•…ν•  μ μλ‹¤**)
- μ¤‘λ³µμ΄ μ κ±° λμ—μΌλ―€λ΅ (`new MemoryMemberRepository()`), μ΄μ  `MemoryMemberRepository` λ¥Ό λ‹¤λ¥Έ κµ¬ν„μ²΄λ΅ λ³€κ²½ν•  λ• **ν• λ¶€λ¶„λ§ λ³€κ²½ν•λ©΄ λλ‹¤**



## 5. μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

  `AppConfig` μ λ“±μ¥μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ‚¬μ© μμ—­κ³Ό κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , κµ¬μ„±ν•λ” (Configuration) ν•λ” μμ—­μΌλ΅ λ¶„λ¦¬λμ—λ‹¤

- ν• μΈ μ •μ±…μ„ `RateDiscountPolicy` λ΅ λ³€κ²½ν•΄λ„ κµ¬μ„± μμ—­λ§ μν–¥μ„ λ°›κ³ , μ‚¬μ© μμ—­(`OrderServiceImpl`)μ€ **μ „ν€ μν–¥μ„ λ°›μ§€ μ•λ”λ‹¤** (μ‚¬μ© μμ—­μ μ–΄λ– ν• μ½”λ“λ„ λ³€κ²½ν•  ν•„μ”κ°€ μ—†λ‹¤)

  ```java
  public class AppConfig {
  		public DiscountPolicy discountPolicy() {
  				// return new FixDiscountPolicy();
  				return new RateDiscountPolicy();
  		}
  }
  ```



## 6. μ •λ¦¬

### μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

- λ‹¤ν•μ„± λ•λ¶„μ— μƒλ΅μ΄ μ •λ¥  ν• μΈ μ •μ±… μ½”λ“λ¥Ό μ¶”κ°€λ΅ κ°λ°ν•λ” κ²ƒ μμ²΄λ” λ¬Έμ κ°€ μ—†μ—λ‹¤

### μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

- μƒλ΅ κ°λ°ν• μ •λ¥  ν• μΈ μ •μ±…μ„ μ‹¤μ λ΅ μ μ©ν•κ³ μ ν•λ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈ `OrderServiceImpl` , μ¦‰ μ£Όλ¬Έ μ„λΉ„μ¤ **κµ¬ν„μ²΄λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν•¨** => **OCP μ„λ°**
  - μ£Όλ¬Έ μ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈ (`OrderServiceImpl`) κ°€ μ¶”μƒν™”(μΈν„°νμ΄μ¤)μΈ `DiscountPolicy` λΏλ§ μ•„λ‹λΌ κµ¬μ²΄ ν΄λμ¤μΈ  `FixDiscountPolicy` κΉμ§€λ„ ν•¨κ» μμ΅΄ν–κΈ° λ•λ¬Έ
    - μ¦‰, **DIP μ„λ°** (μ¶”μƒν™”μ—λ§ μμ΅΄ν•΄μ•Όν•λ”λ° κµ¬ν„μ²΄κΉμ§€ μμ΅΄ν•κ³  μλ‹¤)



### κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

- μ• ν”λ¦¬μΌ€μ΄μ…μ„ ν•λ‚μ κ³µμ—°μΌλ΅ μƒκ°ν•΄λ³΄μ
  - κΈ°μ΅΄μ—λ” ν΄λΌμ΄μ–ΈνΈκ°€ μμ΅΄ν•λ” μ„λ²„ κµ¬ν„ κ°μ²΄λ¥Ό μ§μ ‘ μƒμ„±ν•κ³ , μ‹¤ν–‰ν•μ€λ‹¤
  - μ¦‰, κΈ°μ΅΄μ—λ” λ°°μ°κ°€ κ³µμ—°λ„ν•κ³ , λ™μ‹μ— λ‹¤λ¥Έ μ£ΌμΈκ³µλ„ μ§μ ‘ μ„­μ™Έν•΄μ•Ό ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μμ—λ κ²©
- κ³µμ—°μ„ κµ¬μ„±ν•κ³ , λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„­μ™Έν•κ³  μ§€μ •ν•λ” μ±…μ„μ„ λ‹΄λ‹Ήν•λ” λ³„λ„μ κ³µμ—° κΈ°νμκ°€ λ‚μ™€μ•Ό ν•¨
  - **`AppConfig` μ λ“±μ¥**
- `AppConfig` λ” μ• ν”λ¦¬μΌ€μ΄μ… **μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±**ν•κΈ° μ„ν•΄, **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°**ν•λ” μ±…μ„μ„ κ°€μ§„λ‹¤
- μ΄μ  ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μμ‹ μ μ—­ν• μ„ μ‹¤ν–‰ν•λ” κ²ƒμ—λ§ μ§‘μ¤‘ν•κ³ , κ¶ν•μ΄ μ¤„μ–΄λ“ λ‹¤ (κ°μ²΄μ μ±…μ„μ΄ λ…ν™•ν•΄μ§„λ‹¤)



### AppConfig λ¦¬ν©ν„°λ§

- κµ¬μ„± μ •λ³΄μ—μ„ **μ—­ν• κ³Ό κµ¬ν„μ„ λ…ν™•ν•κ² λ¶„λ¦¬**
- μ¤‘λ³µμ„ μ κ±°ν•μ—¬ μ—­ν• μ„ μ λ“λ¬λ‚Έλ‹¤



### μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

- **`AppConfig` μ λ“±μ¥**μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν¬κ² **μ‚¬μ© μμ—­**κ³Ό κ°μ²΄λ¥Ό μƒμ„±ν•κ³  **κµ¬μ„±ν•λ” μμ—­**μΌλ΅ λ¶„λ¦¬λ¨
- λ”°λΌμ„, μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ μ μ©ν•λ”λΌλ„ κµ¬μ„± μμ—­(`AppConfig`)λ§ λ³€κ²½ν•λ©΄ λλ‹¤ (μ‚¬μ© μμ—­ λ° ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ λ³€κ²½ν•  ν•„μ”κ°€ μ—†λ‹¤)



## 7. μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™ μ μ©

- μ—¬κΈ°μ„λ” 3κ°€μ§€ **SRP, DIP, OCP** μ μ©

### 1. SRP λ‹¨μΌ μ±…μ„ μ›μΉ™

> SRP (Single Responsibility Principle)
>
> -  **ν• ν΄λμ¤λ” ν•λ‚μ μ±…μ„λ§ κ°€μ Έμ•Ό ν•λ‹¤**
> -  ν•λ‚μ μ±…μ„μ΄λΌλ” κ²ƒμ€ λ¨νΈν•λ‹¤
>    - ν΄ μ μκ³ , μ‘μ„ μλ„ μλ‹¤
>    - λ¬Έλ§¥κ³Ό μƒν™©μ— λ”°λΌ λ‹¤λ¥΄λ‹¤
> -  κ·Έλ¬λ©΄ μ–΄λ–¤ κ²ƒμ„ λ³΄κ³  μ„¤κ³„κ°€ μ λμ—λ‹¤κ³  ν•λ”κ°€?
> -  β­οΈ μ¤‘μ”ν• κΈ°μ¤€μ€ **λ³€κ²½**μ΄λ‹¤. λ³€κ²½μ΄ μμ„ λ• νκΈ‰ ν¨κ³Όκ°€ μ μΌλ©΄ λ‹¨μΌ μ±…μ„ μ›μΉ™μ„ μ λ”°λ¥Έ κ²ƒμ΄λ‹¤
>    - ex) UI λ³€κ²½, κ°μ²΄μ μƒμ„±κ³Ό μ‚¬μ©μ„ λ¶„λ¦¬

- λ§¨ μ²μ ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ§μ ‘ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μλ‹¤κ°€
- SRP λ‹¨μΌ μ±…μ„ μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ **κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬**ν•¨
  - κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ±…μ„μ€ `AppConfig` κ°€ λ‹΄λ‹Ήν•κ² λ¨
  - ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ‹¤ν–‰ν•λ” μ±…μ„λ§ λ‹΄λ‹Ήν•κ² λ¨



###  2. DIP μμ΅΄ κ΄€κ³„ μ—­μ „ μ›μΉ™

> DIP (Denpendency Injection Principle)
>
> - ν”„λ΅κ·Έλλ¨Έλ” **"μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤."** μμ΅΄μ„± μ£Όμ…μ€ μ΄ μ›μΉ™μ„ λ”°λ¥΄λ” λ°©λ²• μ¤‘ ν•λ‚λ‹¤
> - ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ **κµ¬ν„ ν΄λμ¤μ— μμ΅΄ν•μ§€ λ§κ³ , μΈν„°νμ΄μ¤μ— μμ΅΄ν•λΌ**λ” λ»μ΄λ‹¤ (κµ¬ν„ ν΄λμ¤λ§ λ°”λΌλ³΄μ§€ λ§κ³ , μΈν„°νμ΄μ¤λ§ λ°”λΌλ΄λΌ)

- λ§¨ μ²μ, μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ κ°λ°ν•κ³ , μ μ©ν•λ ¤κ³  ν•λ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Όν–λ‹¤
  - ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈ `OrderServiceImpl` μ€ DIPλ¥Ό μ§€ν‚¤λ©° `DiscountPolicy` μ¶”μƒν™” μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ” κ²ƒ κ°™μ•μ§€λ§, μ‚¬μ‹¤μ€ `FixDiscountPolicy` κµ¬μ²΄ν™” κµ¬ν„ ν΄λμ¤μ—λ„ **ν•¨κ» μμ΅΄**ν–κΈ° λ•λ¬Έμ΄λ‹¤
- κ·Έλμ„! ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ `DiscountPolicy` μ¶”μƒν™” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤
  - ν•μ§€λ§, ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μΈν„°νμ΄μ¤λ§μΌλ΅λ” μ•„λ¬΄κ²ƒλ„ μ‹¤ν–‰ ν•  μ μ—†μΌλ―€λ΅, (`NullPointerException`)
  - `AppConfig` κ°€ `FixDiscountPolicy` κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ€μ‹  μƒμ„±ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μμ΅΄ κ΄€κ³„λ¥Ό μ£Όμ…ν–λ‹¤.
- μ΄λ ‡κ²ν•΄μ„ DIP μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ λ¬Έμ λ„ ν•΄κ²°ν–λ‹¤.



### 3. OCP κ°λ°© νμ‡„ μ›μΉ™

> OCP (Open Closed Principle)
>
> - μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” **ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤**

- λ‹¤ν•μ„± μ‚¬μ©ν•κ³ , ν΄λΌμ΄μ–ΈνΈκ°€ DIPλ¥Ό μ§€ν‚¤λ„λ΅ ν•κ³ , μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­μΌλ΅ λ‚λ„μ—λ‹¤
- `AppConfig` κ°€ μμ΅΄κ΄€κ³„λ¥Ό `FixDiscountPolicy` μ—μ„ `RateDiscountPolicy ` λ΅ λ³€κ²½ν•μ—¬ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μ£Όμ…ν•λ―€λ΅, μ΄μ  ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ³€κ²½ν•μ§€ μ•μ•„λ„ λλ‹¤
- **μ†ν”„νΈμ›¨μ–΄ μ”μ†λ¥Ό μƒλ΅­κ² ν™•μ¥ν•΄λ„ μ‚¬μ© μμ—­μ λ³€κ²½μ€ λ‹«ν€ μκ² λλ‹¤.!! (λ³€κ²½μ€ λ‹«ν€μλ‹¤ = μ‚¬μ© μμ—­ λλ” ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•  ν•„μ”κ°€ μ—†λ‹¤)**



## 8. IoC, DI, κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„

- κΈ°μ΅΄ ν”„λ΅κ·Έλ¨
  - ν΄λΌμ΄μ–ΈνΈ κµ¬ν„ κ°μ²΄κ°€ μ¤μ¤λ΅ ν•„μ”ν• μ„λ²„ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν•¨
  - **κµ¬ν„ κ°μ²΄κ°€ ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ κ°€μ Έκ°”λ‹¤**
- `AppConfig` μ λ“±μ¥ μ΄ν›„
  - κµ¬ν„ κ°μ²΄λ” μμ‹ μ λ΅μ§μ„ μ‹¤ν–‰ν•λ” μ—­ν• λ§ λ‹΄λ‹Ή
    - `OrderServiceImpl` μ€ ν•„μ”ν• μΈν„°νμ΄μ¤λ¥Ό νΈμ¶ν•μ§€λ§, μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ μ‹¤ν–‰λλ”μ§€λ” λ¨λ¥Έλ‹¤
  - ν”„λ΅κ·Έλ¨ **μ μ–΄ νλ¦„**λ„  μ΄μ  `AppConfig` κ°€ λ‹΄λ‹Ή
    - `OrderServiceImpl` μ— μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ μ¤λ”μ§€ `OrderServiceImpl` μ€ λ¨λ¥Έλ‹¤
    - μ΄μ  `OrderServiceImpl` λ„ `AppConfig` κ°€ μƒμ„±ν•κ² λ¨

#### ν”„λ΅κ·Έλ¨ μ μ–΄ νλ¦„μ„ μ™Έλ¶€μ—μ„ κ΄€λ¦¬ν•λ” κ²ƒ : IoC (μ μ–΄μ μ—­μ „)

> ν”„λ μ„μ›ν¬ vs λΌμ΄λΈλ¬λ¦¬
>
> - ν”„λ μ„μ›ν¬
>   - λ‚΄κ°€ μ‘μ„±ν• μ½”λ“λ¥Ό ν”„λ μ„μ›ν¬κ°€ μ μ–΄ν•κ³ , λ€μ‹  μ‹¤ν–‰ν•λ‹¤λ©΄ ν”„λ μ„μ›ν¬λ‹¤ (JUnit)
> - λΌμ΄λΈλ¬λ¦¬
>   - λ‚΄κ°€ μ‘μ„±ν• μ½”λ“κ°€ μ μ–΄μ νλ¦„μ„ λ‹΄λ‹Ήν•λ‹¤λ©΄, λΌμ΄λΈλ¬λ¦¬λ‹¤



### DI (Dependency Injection) - μμ΅΄κ΄€κ³„ μ£Όμ…

- `OrderServiceImpl` μ€ `DiscountPolicy` μ— μμ΅΄ν•λ‹¤. μ‹¤μ  μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ μ¤λ”μ§€λ” λ¨λ¥Έλ‹¤.

#### μμ΅΄ κ΄€κ³„λ” μ •μ μΈ ν΄λμ¤ μμ΅΄ κ΄€κ³„μ™€, μ‹¤ν–‰ μ‹μ μ— κ²°μ •λλ” λ™μ μΈ κ°μ²΄ (μΈμ¤ν„΄μ¤) μμ΅΄ κ΄€κ³„ λ‘μ„ λ¶„λ¦¬ν•΄μ„ μƒκ°ν•΄μ•Ό ν•¨



#### 1. μ •μ μΈ ν΄λμ¤ μμ΅΄ κ΄€κ³„

##### ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨

<img src="image/static_class_diagram.png" style="zoom: 50%;" />

- μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•μ§€ μ•μ•„λ„ λ¶„μ„ κ°€λ¥

- ν΄λμ¤κ°€ μ‚¬μ©ν•λ” import λ¬Έ λ§μ„ λ³΄κ³ λ„ νλ‹¨ν•  μ μλ‹¤

- μ‹¤μ  μ–΄λ–¤ κ°μ²΄κ°€ `OrderServiceImpl` μ— μ£Όμ…λ  μ§€ μ• μ μ—†μ

  ```java
  public class OrderServiceImpl implements OrderService {

      private final MemberRepository memberRepository;
      private final DiscountPolicy discountPolicy;

      public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
          this.memberRepository = memberRepository;
          this.discountPolicy = discountPolicy;
      }
  }
  ```

  - μ„ μ½”λ“ λλ” ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨λ§ λ΄μ„λ” μ–΄λ–¤ κ°μ²΄κ°€ μ£Όμ…λ μ§€ μ• μ μ—†λ‹¤



#### 2. λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄ κ΄€κ³„ (μμ΅΄ κ΄€κ³„ μ£Όμ… - Dependency Injection)

<img src="image/instance_diagram.png" alt="image-20211123071309288" style="zoom:50%;" />

- μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹μ μ— **μ‹¤μ  μƒμ„±λ κ°μ²΄ μΈμ¤ν„΄μ¤κ°€ μ°Έμ΅°κ°€ μ—°κ²°λ μμ΅΄ κ΄€κ³„**
- μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹μ μ— μ™Έλ¶€μ—μ„ μ‹¤μ  κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬ν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ‹¤μ  μμ΅΄κ΄€κ³„κ°€ μ—°κ²°λλ” κ²ƒμ„ **μμ΅΄κ΄€κ³„ μ£Όμ…** μ΄λΌκ³  ν•λ‹¤.
- κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•κ³ , κ·Έ μ°Έμ΅°κ°’μ„ μ „λ‹¬ν•΄μ„ μ—°κ²°λλ‹¤
- μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄, ν΄λΌμ΄μ–ΈνΈλ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , ν΄λΌμ΄μ–ΈνΈκ°€ νΈμ¶ν•λ” λ€μƒμ νƒ€μ… μΈμ¤ν„΄μ¤λ¥Ό λ³€κ²½ν•  μ μλ‹¤.



#### β­οΈ μμ΅΄ κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ μ •μ μΈ ν΄λμ¤ μμ΅΄ κ΄€κ³„λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄ κ΄€κ³„λ¥Ό μ‰½κ² λ³€κ²½ν•  μ μλ‹¤



### IoC μ»¨ν…μ΄λ„, DI μ»¨ν…μ΄λ„

- `AppConfig` μ²λΌ **κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬**ν•λ©΄μ„ **μμ΅΄ κ΄€κ³„λ¥Ό μ—°κ²°**ν•΄ μ£Όλ” κ²ƒμ΄ λ°”λ΅ IoC μ»¨ν…μ΄λ„, **DI μ»¨ν…μ΄λ„**μ΄λ‹¤
- μ–΄μ…λΈ”λ¬, μ¤λΈμ νΈ ν©ν† λ¦¬ λ“±μΌλ΅ λ¶λ¦¬κΈ°λ„ ν•λ‹¤



## 9. μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°

#### AppConfig μ¤ν”„λ§ κΈ°λ°μΌλ΅ λ³€κ²½

```java
package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.MemberRepository;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class AppConfig {

    @Bean
    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    @Bean
    public MemoryMemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    @Bean
    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    @Bean
    public DiscountPolicy discountPolicy() {
//        return new FixDiscountPolicy();
        return new RateDiscountPolicy();
    }
}
```

- `AppConfig` μ— μ„¤μ •μ„ κµ¬μ„±ν•λ‹¤λ” λ»μ `@Configuration` μ„ λ¶™μ—¬μ¤
- κ° λ©”μ„λ“μ— `@Bean` μ„ λ¶™μ—¬μ¤
  - μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•¨



### MemberAppμ— μ¤ν”„λ§ μ»¨ν…μ΄λ„ μ μ©

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class MemberApp {
    public static void main(String[] args) {
//        AppConfig appConfig = new AppConfig();
//        MemberService memberService = appConfig.memberService();

        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);

        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new Member = " + member.getName());
        System.out.println("find Member = " + findMember.getName());
    }
}
```



### OrderAppμ— μ¤ν”„λ§ μ»¨ν…μ΄λ„ μ μ©

```java
package hello.core.order;

import hello.core.AppConfig;
import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class OrderApp {
    public static void main(String[] args) {
//        AppConfig appConfig = new AppConfig();
//        MemberService memberService = appConfig.memberService();
//        OrderService orderService = appConfig.orderService();

        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);
        OrderService orderService = applicationContext.getBean("orderService", OrderService.class);

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 20000);
        System.out.println("order = " + order);
        System.out.println("order.calculatePrice = " + order.calculatePrice());
    }
}
```



### μ¤ν”„λ§ μ»¨ν…μ΄λ„

- `ApplicationContext` λ¥Ό **μ¤ν”„λ§ μ»¨ν…μ΄λ„**λΌκ³  ν•λ‹¤
- κΈ°μ΅΄μ—λ” κ°λ°μκ°€ `AppConfig ` λ¥Ό μ‚¬μ©ν•΄μ„ μ§μ ‘ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  DIλ¥Ό ν–μ§€λ§, μ΄μ λ¶€ν„°λ” **μ¤ν”„λ§ μ»¨ν…μ΄λ„**λ¥Ό ν†µν•΄μ„ μ‚¬μ©
- μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” `@Configuration` μ΄ λ¶™μ€ `AppConfig` λ¥Ό μ„¤μ • (κµ¬μ„±) μ •λ³΄λ΅ μ‚¬μ©ν•¨
- `@Bean` μ΄λΌκ³  μ ν **λ©”μ„λ“λ¥Ό λ¨λ‘ νΈμ¶ν•΄μ„ λ°ν™λ κ°μ²΄**λ¥Ό **μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅**ν•¨. μ΄λ ‡κ² μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅λ κ°μ²΄λ¥Ό **μ¤ν”„λ§ λΉ**μ΄λΌκ³  ν•λ‹¤.
  - μ¤ν”„λ§ λΉμ€ `@Bean` μ΄ λ¶™μ€ λ©”μ„λ“μ μ΄λ¦„μ„ λΉμ μ΄λ¦„μΌλ΅ μ‚¬μ©ν•λ‹¤.

- μ΄μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„λ¥Ό ν†µν•΄μ„ ν•„μ”ν• μ¤ν”„λ§ λΉ(κ°μ²΄)μ„ μ°Ύμ•„μ•Ό ν•λ‹¤. μ¤ν”„λ§ λΉμ€ `applicationContext.getBean()` λ©”μ„λ“λ¥Ό μ‚¬μ©ν•΄μ„ μ°Ύμ„ μ μλ‹¤.



κ·Έλ¬λ©΄, μ¤ν”„λ§ μ»¨ν…μ΄λ„λ¥Ό μ‚¬μ©ν•λ©΄ μ–΄λ–¤ μ¥μ μ΄ μλ”κ±ΈκΉ??



## μ¶μ²

[μΈν”„λ° - μ¤ν”„λ§ ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8)
